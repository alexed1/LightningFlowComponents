<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Bulk_Request_Setup</name>
        <label>Test Request Setup for Bulk</label>
        <locationX>1168</locationX>
        <locationY>1173</locationY>
        <actionName>SendBetterEmailBulkRequestSetup</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Bulk_Add_To_List_of_Requests</targetReference>
        </connector>
        <inputParameters>
            <name>HTMLbody</name>
            <value>
                <elementReference>x1_HTML_Body</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>testReturnAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderDisplayName</name>
            <value>
                <elementReference>testSenderName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SendTOthisOneEmailAddress</name>
            <value>
                <elementReference>send_Email_To</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subject</name>
            <value>
                <elementReference>BulkSubject</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>bulkThisSendBetterEmailRequest</assignToReference>
            <name>output</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>X1_Simplest_Better_Email</name>
        <label>1. Simplest Better Email</label>
        <locationX>1511</locationX>
        <locationY>161</locationY>
        <actionName>SendBetterEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>HTMLbody</name>
            <value>
                <elementReference>x1_HTML_Body</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>testReturnAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderDisplayName</name>
            <value>
                <elementReference>testSenderName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SendTOthisOneEmailAddress</name>
            <value>
                <elementReference>send_Email_To</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subject</name>
            <value>
                <elementReference>sendSubject</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>UseSalesforceSignature</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>errorsFromEmail</assignToReference>
            <name>errors</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isSuccess</assignToReference>
            <name>isSuccess</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>X2_Simple_Email_with_Address_Collections_Wit_Collections</name>
        <label>2. Simple Email with Address Collections - With Address Collections</label>
        <locationX>1510</locationX>
        <locationY>277</locationY>
        <actionName>SendBetterEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>HTMLbody</name>
            <value>
                <elementReference>x2_HTML_Body</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>testReturnAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SendBCCtheEmailAddressesFromThisCollectionOfUsers</name>
            <value>
                <elementReference>curUsers</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SendCCtheEmailAddressesFromThisCollectionOfContacts</name>
            <value>
                <elementReference>curContacts</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderDisplayName</name>
            <value>
                <elementReference>testSenderName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SendTOthisStringCollectionOfEmailAddresses</name>
            <value>
                <elementReference>stringCollectionEmailAddresses</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subject</name>
            <value>
                <elementReference>sendSubject</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>errorsFromEmail</assignToReference>
            <name>errors</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isSuccess</assignToReference>
            <name>isSuccess</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>X3_Email_with_Attachments</name>
        <label>3. Email with Attachments</label>
        <locationX>1593</locationX>
        <locationY>406</locationY>
        <actionName>SendBetterEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>contentDocumentAttachments</name>
            <value>
                <elementReference>filtered_cdls</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>HTMLbody</name>
            <value>
                <elementReference>HTMLTextTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>testReturnAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>saveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderDisplayName</name>
            <value>
                <elementReference>testSenderName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SendTOthisOneEmailAddress</name>
            <value>
                <elementReference>send_Email_To</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subject</name>
            <value>
                <elementReference>sendSubject</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>UseSalesforceSignature</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>errorsFromEmail</assignToReference>
            <name>errors</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isSuccess</assignToReference>
            <name>isSuccess</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <description>Email Using Template - An email using a Lightning EmailTemplate</description>
        <name>X4_Email_Using_Template_Action</name>
        <label>4. Email Using Template Action</label>
        <locationX>1561</locationX>
        <locationY>850</locationY>
        <actionName>SendBetterEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>recordId</name>
            <value>
                <elementReference>templateWhatId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>testReturnAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>saveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>saveAsTask</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderDisplayName</name>
            <value>
                <elementReference>testSenderName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateTargetObjectId</name>
            <value>
                <elementReference>templateTargetId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateID</name>
            <value>
                <elementReference>testTemplateId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>UseSalesforceSignature</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>errorsFromEmail</assignToReference>
            <name>errors</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isSuccess</assignToReference>
            <name>isSuccess</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <description>Multi-Lingual Using Email Templates - An email using a Lightning EmailTemplate selected by language</description>
        <name>X5_Multi_Lingual_Using_Email_Templates_Action</name>
        <label>5. Multi-Lingual Using Email Templates</label>
        <locationX>1612</locationX>
        <locationY>983</locationY>
        <actionName>SendBetterEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>recordId</name>
            <value>
                <elementReference>templateWhatId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>testReturnAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>saveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderDisplayName</name>
            <value>
                <elementReference>testSenderName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateLanguage</name>
            <value>
                <elementReference>testTemplateLanguage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateName</name>
            <value>
                <elementReference>testTemplateName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateTargetObjectId</name>
            <value>
                <elementReference>templateTargetId</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>errorsFromEmail</assignToReference>
            <name>errors</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isSuccess</assignToReference>
            <name>isSuccess</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <description>Testing Send Better Email - Mass Email</description>
        <name>X6_Send_Better_Email_Mass</name>
        <label>6. Send Better Email - Mass</label>
        <locationX>1654</locationX>
        <locationY>1112</locationY>
        <actionName>SendBetterEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>description</name>
            <value>
                <elementReference>testMassEmailFinishedMessage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailMessageType</name>
            <value>
                <stringValue>massEmail</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>targetObjectIds</name>
            <value>
                <elementReference>UserListForMassMail</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateName</name>
            <value>
                <elementReference>testTemplateName</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <description>Use the SendBetterEmail Action with a collection of requests</description>
        <name>X7_BulkSendBetterEmail_Action</name>
        <label>7. SendBetterEmail Bulk</label>
        <locationX>1684</locationX>
        <locationY>1273</locationY>
        <actionName>SendBetterEmailBulk</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>emailRequests</name>
            <value>
                <elementReference>bulkSendBetterEmailRequest</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <description>Email Using Template - An email using a Lightning EmailTemplate</description>
        <name>X8_Email_Using_Template_Action</name>
        <label>8. Email Using Template, Recipient, Target, WhatId</label>
        <locationX>1744</locationX>
        <locationY>1394</locationY>
        <actionName>SendBetterEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>ScreenConsole1</targetReference>
        </connector>
        <inputParameters>
            <name>cb_setTreatTargetObjectAsRecipient</name>
            <value>
                <stringValue>CB_FALSE</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>InReplyTo</name>
            <value>
                <elementReference>ListOfInReplyToEmailMessageIds</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recordId</name>
            <value>
                <elementReference>templateWhatId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>testReturnAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>saveAsActivity</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>saveAsTask</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderDisplayName</name>
            <value>
                <elementReference>testSenderName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SendTOthisOneEmailAddress</name>
            <value>
                <elementReference>templateRecipientId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>setTreatTargetObjectAsRecipient</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateTargetObjectId</name>
            <value>
                <elementReference>templateTargetId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>templateID</name>
            <value>
                <elementReference>testTemplateId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>UseSalesforceSignature</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>errorsFromEmail</assignToReference>
            <name>errors</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isSuccess</assignToReference>
            <name>isSuccess</name>
        </outputParameters>
    </actionCalls>
    <apiVersion>49.0</apiVersion>
    <assignments>
        <name>Add_All_Attached_Files</name>
        <label>Add All Attached Files</label>
        <locationX>1501</locationX>
        <locationY>517</locationY>
        <assignmentItems>
            <assignToReference>filtered_cdls</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Content_Document_Links</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X3_Email_with_Attachments</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_CDL_in_Filtered_List</name>
        <label>Add CDL in Filtered List</label>
        <locationX>1453</locationX>
        <locationY>762</locationY>
        <assignmentItems>
            <assignToReference>filtered_cdls</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_cdl</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>cd_counter</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>All_Uploaded_CD_Ids</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Add the messageId to the InReplyTo collection if given</description>
        <name>Add_MessageId_to_Collection</name>
        <label>Add MessageId to Collection</label>
        <locationX>1594</locationX>
        <locationY>1449</locationY>
        <assignmentItems>
            <assignToReference>ListOfInReplyToEmailMessageIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>MessageId_of_existing_email_if_this_is_InReplyTo</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X8_Email_Using_Template_Action</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_User_ID_for_TargetIds</name>
        <label>Assign User ID for TargetIds</label>
        <locationX>1361</locationX>
        <locationY>1112</locationY>
        <assignmentItems>
            <assignToReference>UserListForMassMail</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>UserIdRunningFlow</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X6_Send_Better_Email_Mass</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Bulk_Add_To_List_of_Requests</name>
        <label>Add To List of Requests</label>
        <locationX>1540</locationX>
        <locationY>1173</locationY>
        <assignmentItems>
            <assignToReference>bulkSendBetterEmailRequest</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>bulkThisSendBetterEmailRequest</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>bulk_counter</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Bulk_Set_up_Test_Requests</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Add the first email to the string collection</description>
        <name>Email_1_to_Collection</name>
        <label>Email 1 to Collection</label>
        <locationX>961</locationX>
        <locationY>419</locationY>
        <assignmentItems>
            <assignToReference>stringCollectionEmailAddresses</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>testEmailAddress1</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Email_Addr_2</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Email_2_to_Collection</name>
        <label>Email 2 to Collection</label>
        <locationX>1134</locationX>
        <locationY>277</locationY>
        <assignmentItems>
            <assignToReference>stringCollectionEmailAddresses</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>testEmailAddress2</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Users</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>You can&apos;t use a screen input component directly unless that component has an output assignment in it (Winter &apos;21, but possibly Summer &apos;21 will change that [safe harbor]), so this captures the output from the components and manually puts them into a usable variable.</description>
        <name>X1_Assignments</name>
        <label>X1_Assignments</label>
        <locationX>956</locationX>
        <locationY>161</locationY>
        <assignmentItems>
            <assignToReference>sendSubject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X1_Screen_Subject</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testSenderName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X1_Screen_Sender_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>x1_HTML_Body</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X1_Screen_HTML_Body</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X1_Simplest_Better_Email</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>You can&apos;t use a screen input component directly unless that component has an output assignment in it (Winter &apos;21, but possibly Summer &apos;21 will change that [safe harbor]), so this captures the output from the components and manually puts them into a usable variable.

Also create an empty string collection of email addresses</description>
        <name>X2_Assignments</name>
        <label>X2_Assignments</label>
        <locationX>823</locationX>
        <locationY>269</locationY>
        <assignmentItems>
            <assignToReference>sendSubject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X2_Screen_Subject</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testSenderName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X2_Screen_Sender_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>stringCollectionEmailAddresses</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>x2_HTML_Body</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X2_Screen_HTML_Body</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Email_Addr_1</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>You can&apos;t use a screen input component directly unless that component has an output assignment in it (Winter &apos;21, but possibly Summer &apos;21 will change that [safe harbor]), so this captures the output from the components and manually puts them into a usable variable.</description>
        <name>X3_Assignments</name>
        <label>X3_Assignments</label>
        <locationX>831</locationX>
        <locationY>627</locationY>
        <assignmentItems>
            <assignToReference>sendSubject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X3_Screen_Subject</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testSenderName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X3_Screen_Sender_Name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>File_Upload_to_Attach</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign variables from screen</description>
        <name>X4_Assign_from_Screen</name>
        <label>4. Assign from Screen</label>
        <locationX>1246</locationX>
        <locationY>854</locationY>
        <assignmentItems>
            <assignToReference>testSenderName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X4_Screen_Sender_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>templateTargetId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X4_Screen_Template_Target_Record_Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>templateWhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X4_Screen_Related_RecordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X4_Email_Using_Template_Action</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>X4_Assign_Template</name>
        <label>4. Assign Template</label>
        <locationX>1104</locationX>
        <locationY>763</locationY>
        <assignmentItems>
            <assignToReference>testTemplateId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X4_Screen_Template_RecordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X4_Assign_from_Screen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign variables from screen</description>
        <name>X5_Assign_from_Screen</name>
        <label>5. Assign from Screen</label>
        <locationX>790</locationX>
        <locationY>983</locationY>
        <assignmentItems>
            <assignToReference>testSenderName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X5_Screen_Sender_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>templateTargetId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X5_Screen_Template_Target_Record_Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>templateWhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X5_Screen_Related_Record_Id_for_testing_merge_fields_5</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testTemplateName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X5_Screen_Template_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testTemplateLanguage</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X5_Screen_Template_Language</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X5_Create_Test_Templates_if_Needed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign screen input to variables</description>
        <name>X6_Assign_from_Screen</name>
        <label>6. Assign from Screen</label>
        <locationX>792</locationX>
        <locationY>1112</locationY>
        <assignmentItems>
            <assignToReference>testTemplateName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X6_Template_Name_Mass_Email</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testMassEmailFinishedMessage</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X6_Finished_Message_Description</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X6_Create_Mass_Email_Test_Templates_If_Needed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Set Up the Text Subjects</description>
        <name>X7_Bulk_Set_Up_Text_Subjects</name>
        <label>7. Set Up Text Subjects</label>
        <locationX>1034</locationX>
        <locationY>1275</locationY>
        <assignmentItems>
            <assignToReference>bulk_counter</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testSenderName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X7_Screen_Sender_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>testSubject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X7_Screen_Subject</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>x1_HTML_Body</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X7_Screen_HTML_Body</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>bulkSubjectNames</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>Temp Subject 1</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>bulkSubjectNames</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>Temp Subject 2</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Bulk_Set_up_Test_Requests</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign variables from screen</description>
        <name>X8_Assign_from_Screen</name>
        <label>8. Assign from Screen</label>
        <locationX>1237</locationX>
        <locationY>1394</locationY>
        <assignmentItems>
            <assignToReference>testSenderName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X8_Screen_Sender_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>templateTargetId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X8_Screen_Template_Target_Record_Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>templateWhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X8_Screen_Related_RecordId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>templateRecipientId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X8_Screen_Recipient_Record_ID</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>InReplyTo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>X8_Assign_Template</name>
        <label>8. Assign Template</label>
        <locationX>783</locationX>
        <locationY>1386</locationY>
        <assignmentItems>
            <assignToReference>testTemplateId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>X8_Screen_Template_RecordId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>X8_Assign_from_Screen</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>whichExampleChoice1</name>
        <choiceText>1) Simple Email Text - with To, Sender, Reply-To, Subject, Body (All text)</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </choices>
    <choices>
        <name>whichExampleChoice2</name>
        <choiceText>2) Simple Email with Address Collections - Using Address Collections to Send to Multiple Recipients</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>2.0</numberValue>
        </value>
    </choices>
    <choices>
        <name>whichExampleChoice3</name>
        <choiceText>3) Email with Attachments - Simple Email (1) With Attachments</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>3.0</numberValue>
        </value>
    </choices>
    <choices>
        <name>whichExampleChoice4</name>
        <choiceText>4) Email Using Template - An email using a Lightning EmailTemplate</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>4.0</numberValue>
        </value>
    </choices>
    <choices>
        <name>whichExampleChoice5</name>
        <choiceText>5) Multi-Lingual Using Email Templates - An email using a Lightning EmailTemplate selected by language</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>5.0</numberValue>
        </value>
    </choices>
    <choices>
        <name>whichExampleChoice6</name>
        <choiceText>&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;6) Mass Email Example&lt;/span&gt;</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>6.0</numberValue>
        </value>
    </choices>
    <choices>
        <name>whichExampleChoice7</name>
        <choiceText>&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;7) Bulk Email using Request Collection&lt;/span&gt;</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>7.0</numberValue>
        </value>
    </choices>
    <choices>
        <name>whichExampleChoice8</name>
        <choiceText>&lt;span style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;8) Email Using Template - An email using a Lightning EmailTemplate  &lt;/span&gt;&lt;span style=&quot;color: rgb(156, 220, 254);&quot;&gt;setTreatTargetObjectAsRecipient FALSE&lt;/span&gt;</choiceText>
        <dataType>Number</dataType>
        <value>
            <numberValue>8.0</numberValue>
        </value>
    </choices>
    <constants>
        <description>The Default Mass Email Template Name</description>
        <name>DefaultMassEmailTemplateName</name>
        <dataType>String</dataType>
        <value>
            <stringValue>sendMassBetterEmailTest</stringValue>
        </value>
    </constants>
    <constants>
        <name>DefaultRecipientEmailAddress1</name>
        <dataType>String</dataType>
        <value>
            <stringValue>john.doe@example.com.invalid</stringValue>
        </value>
    </constants>
    <constants>
        <name>DefaultRecipientEmailAddress2</name>
        <dataType>String</dataType>
        <value>
            <stringValue>jane.roe@example.com.invalid</stringValue>
        </value>
    </constants>
    <constants>
        <description>The default Recipient Record Type for Recipient Addresses and Fields used in Template Merges</description>
        <name>DefaultRecipientRecordType</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Contact</stringValue>
        </value>
    </constants>
    <constants>
        <description>The default Related Record type for template related record field merges</description>
        <name>DefaultRelatedRecordType</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Account</stringValue>
        </value>
    </constants>
    <constants>
        <name>DefaultReplyToEmail</name>
        <dataType>String</dataType>
        <value>
            <stringValue>DoNotReply@example.com.invalid</stringValue>
        </value>
    </constants>
    <constants>
        <description>The default sender email address for test examples</description>
        <name>DefaultSenderEmailAddress</name>
        <dataType>String</dataType>
        <value>
            <stringValue>donotreply@example.com.invalid</stringValue>
        </value>
    </constants>
    <constants>
        <description>Default sender name for examples</description>
        <name>DefaultSenderName</name>
        <dataType>String</dataType>
        <value>
            <stringValue>DoNotReply</stringValue>
        </value>
    </constants>
    <constants>
        <description>The default test Language for examples</description>
        <name>DefaultTemplateLanguage</name>
        <dataType>String</dataType>
        <value>
            <stringValue>es_MX</stringValue>
        </value>
    </constants>
    <constants>
        <description>Default Name for Email Template</description>
        <name>DefaultTemplateName</name>
        <dataType>String</dataType>
        <value>
            <stringValue>sendBetterEmailTest</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Any_Files_Uploaded</name>
        <label>Any Files Uploaded?</label>
        <locationX>1322</locationX>
        <locationY>450</locationY>
        <defaultConnector>
            <targetReference>Add_All_Attached_Files</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Any_Files_Uploaded_yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>cd_counter</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X3_Email_with_Attachments</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>CDL_In_Just_Uploaded_Files</name>
        <label>CDL In Just Uploaded Files</label>
        <locationX>1448</locationX>
        <locationY>651</locationY>
        <defaultConnector>
            <targetReference>All_Uploaded_CD_Ids</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>CDL_In_Just_Uploaded_Files_yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>cur_cdl.ContentDocumentId</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>cur_cd_id</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_CDL_in_Filtered_List</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Email_Addr_1</name>
        <label>Email Addr 1</label>
        <locationX>952</locationX>
        <locationY>271</locationY>
        <defaultConnector>
            <targetReference>Email_1_to_Collection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Email 1</defaultConnectorLabel>
        <rules>
            <name>No_Email_1</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>testEmailAddress1</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <conditions>
                <leftValueReference>testEmailAddress1</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Email_Addr_2</targetReference>
            </connector>
            <label>No Email 1?</label>
        </rules>
    </decisions>
    <decisions>
        <name>Email_Addr_2</name>
        <label>Email Addr 2</label>
        <locationX>1125</locationX>
        <locationY>414</locationY>
        <defaultConnector>
            <targetReference>Email_2_to_Collection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Email 2</defaultConnectorLabel>
        <rules>
            <name>No_Email_2</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>testEmailAddress2</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <conditions>
                <leftValueReference>testEmailAddress2</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Users</targetReference>
            </connector>
            <label>No Email 2?</label>
        </rules>
    </decisions>
    <decisions>
        <description>Was an InReplyTo Message ID entered?</description>
        <name>InReplyTo</name>
        <label>InReplyTo MessageId Given?</label>
        <locationX>1429</locationX>
        <locationY>1396</locationY>
        <defaultConnector>
            <targetReference>X8_Email_Using_Template_Action</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No InReplyTo</defaultConnectorLabel>
        <rules>
            <name>InReplyTo_MessageId_Entered</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MessageId_of_existing_email_if_this_is_InReplyTo</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_MessageId_to_Collection</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Choice</name>
        <label>Which Choice</label>
        <locationX>614</locationX>
        <locationY>469</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Ex_1</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice1</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X1_Get_Simple_Email_Fields</targetReference>
            </connector>
            <label>1 Simple Email</label>
        </rules>
        <rules>
            <name>Ex_2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice2</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X2_Get_Simple_Email_Fields_Collections</targetReference>
            </connector>
            <label>2. Simple Email with Address Collection</label>
        </rules>
        <rules>
            <name>Ex_3</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice3</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Simple_Email_Fields_Attachments</targetReference>
            </connector>
            <label>3. Email with Attachments</label>
        </rules>
        <rules>
            <name>Ex_4</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice4</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X4_Email_Using_Template</targetReference>
            </connector>
            <label>4. Email Using Template</label>
        </rules>
        <rules>
            <name>Ex_5</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice5</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X5_Multi_Lingual_Using_Email_Templates</targetReference>
            </connector>
            <label>5. Multi-Lingual Using Email Templates</label>
        </rules>
        <rules>
            <name>Ex_6</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice6</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X6_Mass_Email</targetReference>
            </connector>
            <label>6. Mass Email</label>
        </rules>
        <rules>
            <name>X7_Bulk_Email_Send_bulk_email_using_request_collections</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice7</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X7_Bulk_email_using_request_collection</targetReference>
            </connector>
            <label>7, Bulk Email - Send bulk email using request collections</label>
        </rules>
        <rules>
            <name>X8_Email_Template_Target_Not_Recipient</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_Example</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>whichExampleChoice8</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X8_Email_Using_Template</targetReference>
            </connector>
            <label>8. Email Template Target Not Recipient</label>
        </rules>
    </decisions>
    <decisions>
        <name>X4_TemplateID_Identified</name>
        <label>4. TemplateID Provided</label>
        <locationX>706</locationX>
        <locationY>772</locationY>
        <defaultConnector>
            <targetReference>X4_Create_Test_Templates_if_Needed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Check to Add</defaultConnectorLabel>
        <rules>
            <name>X4_TID_Provided</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>X4_Screen_Template_RecordId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>X4_Screen_Template_RecordId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X4_Assign_Template</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>X8_TemplateID_Identified</name>
        <label>8. TemplateID Provided</label>
        <locationX>394</locationX>
        <locationY>1394</locationY>
        <defaultConnector>
            <targetReference>X8_Create_Test_Templates_if_Needed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Check to Add</defaultConnectorLabel>
        <rules>
            <name>X8_TID_Provided</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>X8_Screen_Template_RecordId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>X8_Screen_Template_RecordId</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue/>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X8_Assign_Template</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <description>A series of 5 examples for testing and demonstrating Send Better Email Action Component</description>
    <formulas>
        <description>Create a unique bulk subject name for each request</description>
        <name>BulkSubject</name>
        <dataType>String</dataType>
        <expression>{!testSubject} + &quot;: Request #: &quot; + text({!bulk_counter})</expression>
    </formulas>
    <formulas>
        <description>The subject for the mass email finished notification</description>
        <name>TestFlowMassSubject</name>
        <dataType>String</dataType>
        <expression>&apos;Finished Mass Email Send: sendBetterEmail Test:  Flow Example  &apos; + text({!Choose_Example})</expression>
    </formulas>
    <formulas>
        <description>Create a test flow subject for the appropriate flow</description>
        <name>TestFlowSubject</name>
        <dataType>String</dataType>
        <expression>&apos;sendBetterEmail Test:  Flow Example  &apos; + text({!Choose_Example})</expression>
    </formulas>
    <formulas>
        <description>Create a plaintext message with line feeds</description>
        <name>testPlainTextLineFeeds</name>
        <dataType>String</dataType>
        <expression>&apos;Plaintext Line 1&apos;&amp;BR()&amp;&apos;Plaintext Line 2&apos;&amp;BR()&amp;&apos;Plaintext Line 3&apos;</expression>
    </formulas>
    <formulas>
        <description>The user ID of the user running the flow</description>
        <name>UserIdRunningFlow</name>
        <dataType>String</dataType>
        <expression>{!$User.Id}</expression>
    </formulas>
    <interviewLabel>Send Better Email Testflow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Send Better Email Testflow</label>
    <loops>
        <name>All_CDL</name>
        <label>All CDL</label>
        <locationX>1214</locationX>
        <locationY>534</locationY>
        <assignNextValueToReference>cur_cdl</assignNextValueToReference>
        <collectionReference>Get_Content_Document_Links</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>All_Uploaded_CD_Ids</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Any_Files_Uploaded</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>All_Uploaded_CD_Ids</name>
        <label>All Uploaded CD Ids</label>
        <locationX>1213</locationX>
        <locationY>658</locationY>
        <assignNextValueToReference>cur_cd_id</assignNextValueToReference>
        <collectionReference>content_document_ids</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>CDL_In_Just_Uploaded_Files</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>All_CDL</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop through for each of the subjects</description>
        <name>Bulk_Set_up_Test_Requests</name>
        <label>7. Set up Test Requests</label>
        <locationX>1375</locationX>
        <locationY>1267</locationY>
        <collectionReference>bulkSubjectNames</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Bulk_Request_Setup</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>X7_BulkSendBetterEmail_Action</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <name>Get_Contacts</name>
        <label>Get Contacts</label>
        <locationX>1395</locationX>
        <locationY>277</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>X2_Simple_Email_with_Address_Collections_Wit_Collections</targetReference>
        </connector>
        <faultConnector>
            <targetReference>X2_Simple_Email_with_Address_Collections_Wit_Collections</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>Contains</operator>
            <value>
                <elementReference>X2_Screen_Test_Contact_Recipient_Contains</elementReference>
            </value>
        </filters>
        <object>Contact</object>
        <outputReference>curContacts</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Email</queriedFields>
        <queriedFields>FirstName</queriedFields>
        <queriedFields>LastName</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Content_Document_Links</name>
        <label>Get Content Document Links</label>
        <locationX>1125</locationX>
        <locationY>534</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>All_CDL</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>LinkedEntityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$User.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ContentDocumentLink</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>ContentDocumentId</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Users</name>
        <label>Get Users</label>
        <locationX>1262</locationX>
        <locationY>277</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Contacts</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Get_Contacts</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Username</field>
            <operator>Contains</operator>
            <value>
                <elementReference>X2_Screen_Test_User_Recipient_Contains</elementReference>
            </value>
        </filters>
        <object>User</object>
        <outputReference>curUsers</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Email</queriedFields>
        <queriedFields>FirstName</queriedFields>
        <queriedFields>LastName</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>X4_Get_Id_From_TemplateName</name>
        <label>4. Get Id From TemplateName</label>
        <locationX>1021</locationX>
        <locationY>860</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>X4_Assign_from_Screen</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>X4_Screen_Email_Template_Name</elementReference>
            </value>
        </filters>
        <object>EmailTemplate</object>
        <outputAssignments>
            <assignToReference>testTemplateId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>X8_Get_Id_From_TemplateName</name>
        <label>8. Get Id From TemplateName</label>
        <locationX>986</locationX>
        <locationY>1466</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>X8_Assign_from_Screen</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>X8_Screen_Email_Template_Name</elementReference>
            </value>
        </filters>
        <object>EmailTemplate</object>
        <outputAssignments>
            <assignToReference>testTemplateId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <screens>
        <name>Choose_Example_Screen</name>
        <label>Choose Example</label>
        <locationX>523</locationX>
        <locationY>311</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Which_Choice</targetReference>
        </connector>
        <fields>
            <name>SelectExampleInstructions</name>
            <fieldText>&lt;p&gt;Select the example/test you would like to execute.  For examples 3-5, you will need to do some prior setup of records and/or templates as described in the instructions for each when selected.  The choices are:&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;background-color: rgba(25, 30, 35, 0.2);&quot;&gt;1) Simple Email Text&lt;/b&gt; - &lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Sends a simple better text email&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;2) Simple Email with Address Collections&lt;/b&gt; - &lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Send an email using collections of recipients.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;3) Email with Attachments&lt;/b&gt; - &lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Attachments and Signature&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;4) Email Using Template&lt;/b&gt; -&lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Single Mail Template with merge fields from Recipient Record, Related To Record, Activity to Recipient and Task to Related To&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;5) Multi-Lingual Using Email Templates&lt;/b&gt; - Sending &lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Multi-Lingual with Email Templates&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;6) Mass Email&lt;/b&gt; - Send an email using MassEmail messaging&lt;/p&gt;&lt;p&gt;&lt;b&gt;7) Bulk Email &lt;/b&gt;- Send bulk email using request collections&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;8) Email Using Template Target Not Recipient&lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt; -&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60); font-size: 10.5pt; font-family: Arial, sans-serif;&quot;&gt;Single Mail Template with merge fields from Target Record, Related To Record, Different Recipient&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;NOTE&lt;/b&gt;:  By default, &lt;span style=&quot;color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;UseSalesforceSignature and saveAsActivity are set to true if unspecified.  This often has unintended consequences, so  explicitly setting these variables is best practice - especially if they are not desired features.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Choose_Example</name>
            <choiceReferences>whichExampleChoice1</choiceReferences>
            <choiceReferences>whichExampleChoice2</choiceReferences>
            <choiceReferences>whichExampleChoice3</choiceReferences>
            <choiceReferences>whichExampleChoice4</choiceReferences>
            <choiceReferences>whichExampleChoice5</choiceReferences>
            <choiceReferences>whichExampleChoice6</choiceReferences>
            <choiceReferences>whichExampleChoice7</choiceReferences>
            <choiceReferences>whichExampleChoice8</choiceReferences>
            <dataType>Number</dataType>
            <fieldText>Choose Example</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
            <scale>0</scale>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>File_Upload_to_Attach</name>
        <label>Upload Files to Attach</label>
        <locationX>959</locationX>
        <locationY>627</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_Content_Document_Links</targetReference>
        </connector>
        <fields>
            <name>file_apload_sc</name>
            <extensionName>forceContent:fileUpload</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>File Upload</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>recordId</name>
                <value>
                    <elementReference>$User.Id</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>multiple</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>content_document_ids</assignToReference>
                <name>contentDocIds</name>
            </outputParameters>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Get_Simple_Email_Fields_Attachments</name>
        <label>3. Get Simple Email Fields For Attachments</label>
        <locationX>709</locationX>
        <locationY>627</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X3_Assignments</targetReference>
        </connector>
        <fields>
            <name>Example3Details</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Flow Example 3&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Attachments and Signature.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;This example illustrates how to upload and send attachments using Content Document Links&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Send the attachments added in the flow (related record == current user).&amp;nbsp;It also tests using the signature of the running user.&amp;nbsp;Parameters are:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;to the addressee in [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;TO(&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(8, 7, 7); background-color: white;&quot;&gt;send_Email_To&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;content predefined in the resource [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;HTMLTextTemplate]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;from[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Reply Email Address(TestReturnAddress)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with the name [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Sender Display Name(sendSender)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;using [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Subject(sendSubject)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;and [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Body(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;HTML_Body_3&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with attachments &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;[&lt;/b&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;Attach which Content Document Links&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt; (filtered_cdls)]&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;(Created using document upload then converting documents to Document Versions and Content Document Links to those versions&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;All of the above are flow resource variables.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X3_ToEmailaAdress</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recipient Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>disabled</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>readonly</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>send_Email_To</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X3_Reply_To_Email_Address</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>ReplyTo Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testReturnAddress</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X3_Screen_Sender_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testSenderName</elementReference>
            </defaultValue>
            <fieldText>Sender Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X3_Screen_Subject</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>TestFlowSubject</elementReference>
            </defaultValue>
            <fieldText>Subject</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>ScreenConsole1</name>
        <label>ScreenConsole1</label>
        <locationX>1646</locationX>
        <locationY>169</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>dispResults</name>
            <fieldText>&lt;p&gt;Email Send Results:&lt;/p&gt;&lt;p&gt;IsSuccess: {!isSuccess}&lt;/p&gt;&lt;p&gt;Errors: &lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>X1_Get_Simple_Email_Fields</name>
        <label>1. Get Simple Email Fields</label>
        <locationX>707</locationX>
        <locationY>161</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X1_Assignments</targetReference>
        </connector>
        <fields>
            <name>Example1Details</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;Flow Example 1&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;Sends a rich text email with:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;content predefined in the resource &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;HTMLTextTemplate&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;to the addressee in [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;TO(&lt;/b&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255);&quot;&gt;send_Email_To&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;from[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Reply to Email&lt;/b&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;TestReturnAddress)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with the name [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Sender Display Name(testSenderName)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;using [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Subject(testSubject)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;and [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Body(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;x1_HTML_Body&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;All of the above are flow resource variables. To create a body with line breaks, use a formula variable (see example resource variable testPlainTextLineFeeds)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;Note&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;: To get the full effect of rich text, edit the flow resource formula &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;HTMLTextTemplate&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt; resource instead of modifying the field on this screen.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X1_Screen_Email_To</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recipient Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>disabled</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>readonly</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>send_Email_To</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X1_Screen_Reply_To_Email_Address</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>ReplyTo Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testReturnAddress</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X1_Screen_Sender_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testSenderName</elementReference>
            </defaultValue>
            <fieldText>Sender Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X1_Screen_Subject</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>TestFlowSubject</elementReference>
            </defaultValue>
            <fieldText>Subject</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X1_Screen_HTML_Body</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>HTMLTextTemplate</elementReference>
            </defaultValue>
            <fieldText>HTML Body</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>X2_Get_Simple_Email_Fields_Collections</name>
        <label>2. Get Simple Email Fields &amp; Collections</label>
        <locationX>822</locationX>
        <locationY>405</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X2_Assignments</targetReference>
        </connector>
        <fields>
            <name>Example2Details</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Flow Example 2&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Send an email using collections of recipients.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;The collections are defined by:&lt;/span&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;To: A collection of strings&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;CC: A collection of Contact Ids derived from pre-existing Contacts selected via a contains configuration&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;BCC: A collection of User Ids selected via a contains configuration&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you want to test the Contact Collection, you must specify pre-created contacts using contains which looks for contact names containing the specified string.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you want to test the User Collection, you must specify existing users using contains which looks for user names containing the specified string.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;In the flow, the following are constructed and used for the action:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;TO (stringCollectionEmailAddresses) [from ToEmailAddress_2_1 &amp;amp; ToEmailAddress_2_2]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;CC (curContacts) [from Test_Contact_Recipient_Contains_2]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;BCC (curUsers) [from Test_User_Recipient_Contains_2]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;from[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Reply Email Address(testReturnAddress)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with the name [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Sender Display Name(testSenderName)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;using [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Subject(testSendSubject)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;and [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Body(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;x2_HTML_Body&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;All of the above are flow resource variables.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X2_Screen_EmailAddress_1</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recipient Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>disabled</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>readonly</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testEmailAddress1</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X2_Screen_ToEmailAddress2</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recipient Email Addr 2</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testEmailAddress2</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>readonly</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testEmailAddress2</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testEmailAddress2</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X2_Reply_To_Email_Address</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>ReplyTo Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testReturnAddress</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X2_Screen_Sender_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testSenderName</elementReference>
            </defaultValue>
            <fieldText>Sender Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X2_Screen_Subject</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>TestFlowSubject</elementReference>
            </defaultValue>
            <fieldText>Subject</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X2_Screen_HTML_Body</name>
            <defaultValue>
                <stringValue>{!HTMLTextTemplate}</stringValue>
            </defaultValue>
            <fieldText>Body</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X2_Screen_Test_Contact_Recipient_Contains</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testContactContains</elementReference>
            </defaultValue>
            <fieldText>Test Contact Recipient Contains</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X2_Screen_Test_User_Recipient_Contains</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testContactContains</elementReference>
            </defaultValue>
            <fieldText>Test User Recipient Contains</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>X4_Email_Using_Template</name>
        <label>4. Email Using Template</label>
        <locationX>640</locationX>
        <locationY>847</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X4_TemplateID_Identified</targetReference>
        </connector>
        <fields>
            <name>Example4Details</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Flow Example 4&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt; Single Mail Template with merge fields from Recipient Record, Related To Record, Activity to Recipient and Task to Related To&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;&lt;i&gt;NOTE: Before running this example flow, you must create record(s) for both the Recipient (a contact by default) and the Related Record (an Account Record by default) and have the Record Ids available&lt;/i&gt;&lt;/b&gt;&lt;i style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;This sends out an email using a specified Email Template with the addressee specified through the Recipient Record Id (TargetObjectId) and optionally (dependent on your Template) merge fields with an associated object record (WhatId).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Parameters used:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;sender [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Sender Display Name(sendSender)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;reply to &lt;/span&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;[Reply Email Address&lt;/b&gt;&lt;b&gt;(testReturnAddress)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with&amp;nbsp;[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Email Template Id(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;templateId&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;] (looked up or created if specified by name)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;sent to &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;[&lt;/b&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;Recipient Record Id&lt;/b&gt;&lt;b&gt;(templateTargetId)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;with related record &lt;/span&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;[Related Record Id(templateWhatId)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;Save Email as Activity on Recipient Record(s)&lt;/span&gt;[true]&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;Save Email as Task on recipient related record(s)&lt;/span&gt;[true]&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;For this example, you will need to create or use a template. Templates also require that you have a recipient record (targetObjectId) (e.g., Contact, User, . . .) which must also pre-exist.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;You will be required enter the ID for that record as the Recipient Record Id&lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;. Additionally if you intend to test merge fields (RelatedTo) with your template, You must also pre-create the related object record and have available the Id for that record as the Record Object Id (RecordId).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you are using the defaults, you will also need to:&lt;/span&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Create a Contact (for Recipient Object) and/or have the Id available.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Create an Account (for Related Record) and/or have the Id available.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;This example also creates an activity for the email which will be assigned to the Recipient Record Id and a task related to the Related Record Id.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;Note: These are independently settable in the Action.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you specify template by name and the templates do not exist, they will be created using Contact for the &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;Recipient RecordType and Account for the Related RecordType.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you use the default test templates (&lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;sendBetterEmailTest) the Target ID should be a ContactId and the Related Record should be an AccountId.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X4_Screen_Template_RecordId</name>
            <dataType>String</dataType>
            <fieldText>Email Template Id (If Preferred)</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X4_Screen_Email_Template_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>DefaultTemplateName</elementReference>
            </defaultValue>
            <fieldText>Email Template Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X4_Screen_Template_Target_Record_Id</name>
            <dataType>String</dataType>
            <fieldText>Recipient Record Id (also for template merge fields and recording related Email as an activity)</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;This must be an existing record.  If you are using the default test templates (sendBetterEmailTest), it should be a ContactId&lt;/p&gt;</helpText>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X4_Screen_Related_RecordId</name>
            <dataType>String</dataType>
            <fieldText>Related Record Id (also for template merge fields for related record and creating task on same)</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Related Record Id and Related Record Type both must either be used or blank.   One of them is blank.&lt;/p&gt;</errorMessage>
                <formulaExpression>ISBLANK({!X4_Related_RecordType}) == ISBLANK({!X4_Screen_Related_RecordId})</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>X4_Related_RecordType</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>RelatedRecordType</elementReference>
            </defaultValue>
            <fieldText>Related Record Type</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;&lt;span style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;This must be an existing record of a type that allows File Attachments.  If you are using the default test templates (sendBetterEmailTest), it should be an Accoun&lt;/span&gt;&lt;/p&gt;</helpText>
            <isRequired>false</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Related Record Id and Related Record Type both must either be used or blank.   One of them is blank.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>ISBLANK({!X4_Related_RecordType}) == ISBLANK({!X4_Screen_Related_RecordId})</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>X4_Screen_Reply_To_Email_Address</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>ReplyTo Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testReturnAddress</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X4_Screen_Sender_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testSenderName</elementReference>
            </defaultValue>
            <fieldText>Sender Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>X5_Multi_Lingual_Using_Email_Templates</name>
        <label>5. Multi-Lingual Using Email Templates</label>
        <locationX>583</locationX>
        <locationY>982</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X5_Assign_from_Screen</targetReference>
        </connector>
        <fields>
            <name>Example5Details</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Flow Example 5&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt; Multi-Lingual with Email Templates&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;background-color: white; font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;&lt;i&gt;NOTE: Before running this example flow, you must create record(s) for both the Recipient (a contact by default) and the Related Record (an Account Record by default) and have the Record Ids available&lt;/i&gt;&lt;/b&gt;&lt;i style=&quot;background-color: white; font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;SendBetterEmail provides multi-lingual support within the same flow by allowing the language to be specified, then selecting the appropriate template for that language.&amp;nbsp;For this functionality, each language localization has its own template with all localizations sharing a common EmailTemplate.Name. To differentiate the localizations, add a tag to the Email Template Description field in the format: Language=en_US (or whatever corresponding to your organization localizations)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;This example sends out an email using an Email Template with multiple language versions selected by using the language identifier for a set of specified Email Templates with the language tagged in the description.&amp;nbsp;It uses the Recipient Record Id (Recipient Id) and optionally (dependent on your Template) merge fields with a related object record (What/About Id) in merge fields to customize the email for each recipient/related object.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Parameters used:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;description [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Sender Display Name(sendSender)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: white; font-size: 9pt; font-family: Arial, sans-serif; color: black;&quot;&gt;reply to &lt;/span&gt;&lt;b style=&quot;background-color: white; font-size: 9pt; font-family: Arial, sans-serif; color: black;&quot;&gt;[Reply Email Address&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;(testReturnAddress)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with&amp;nbsp;[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Template Name(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; background-color: white; color: black;&quot;&gt;testTemplateName&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;] (looked up or created if specified by name) (Default: sendBetterEmailTest)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;selecting &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;[Template Language(testTemplateLanguage)]&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;(Default: es_MX)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;sent to &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;[&lt;/b&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; background-color: white; color: black;&quot;&gt;Recipient Record Id&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;(templateTargetId)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: white; font-size: 9pt; font-family: Arial, sans-serif; color: black;&quot;&gt;with related record &lt;/span&gt;&lt;b style=&quot;background-color: white; font-size: 9pt; font-family: Arial, sans-serif; color: black;&quot;&gt;[Related Record Id(templateWhatId)]&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you are using the defaults, prior to running this example, you must:&lt;/span&gt;&lt;/p&gt;&lt;ol&gt;&lt;li style=&quot;text-align: justify;&quot;&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Create a Contact (for Recipient Object) and/or have the Id available.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Create an Account (for Related Record) and/or have the Id available.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you have not already created the Named Template, this example will create an English and Spanish(Mexican) version of that template for you.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;You can, of course, vary the templates and object records to reflect your organization&apos;s needs.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;This sends out an email using a specified EmailTemplate with the addressee specified through the TargetObjectId and optionally (dependent on your Template) merge fields with an associated object record using that record&apos;s Id.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;For this example, you will need to create or use one or more templates. Templates also require that you have a recipient record (targetObjectId) (e.g., Contact, User, . . .) which must also pre-exist. You will be required enter the ID for that record as the &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;(targetObjectId). &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: white; font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Additionally if you intend to test merge fields (RelatedTo) with your template, you must also pre-create the related object record and have available the Id for that record as an ID for the Record Object Id (RecordId).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: white; font-size: 10pt; font-family: Tahoma, sans-serif; color: rgb(62, 62, 60);&quot;&gt;&lt;/span&gt;&lt;span style=&quot;background-color: white; font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you use the default test templates (sendBetterEmailTest) the Target ID should be a ContactId and the Related Record should be an AccountId&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X5_Screen_Template_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>DefaultTemplateName</elementReference>
            </defaultValue>
            <fieldText>Template Name</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;Used&amp;nbsp;in&amp;nbsp;conjunction&amp;nbsp;with&amp;nbsp;Template&amp;nbsp;Language.&amp;nbsp;Finds&amp;nbsp;templates&amp;nbsp;with&amp;nbsp;the&amp;nbsp;name&amp;nbsp;matching&amp;nbsp;Template&amp;nbsp;Name&amp;nbsp;for&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;Language=&quot;xxx_YY&quot;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;&amp;nbsp;in&amp;nbsp;the&amp;nbsp;Description.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</helpText>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X5_Screen_Template_Language</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>DefaultTemplateLanguage</elementReference>
            </defaultValue>
            <fieldText>Template Language</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;Will be in the format lang_Local(e.g. &quot;en_US&quot;) Used&amp;nbsp;in&amp;nbsp;conjunction&amp;nbsp;with&amp;nbsp;Template&amp;nbsp;Name,&amp;nbsp;Finds&amp;nbsp;templates&amp;nbsp;with&amp;nbsp;the&amp;nbsp;name&amp;nbsp;matching&amp;nbsp;Template&amp;nbsp;Name&amp;nbsp;for&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;Language=&quot;xxx_YY&quot;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;&amp;nbsp;in&amp;nbsp;the&amp;nbsp;Description.&amp;nbsp;&amp;nbsp;Template&amp;nbsp;Selection&amp;nbsp;criteria&amp;nbsp;order&amp;nbsp;first&amp;nbsp;found&amp;nbsp;Name&amp;nbsp;with:&amp;nbsp;1)If&amp;nbsp;empty,&amp;nbsp;Org&amp;nbsp;LanguageLocaleKey&amp;nbsp;2)Language&amp;nbsp;found&amp;nbsp;in&amp;nbsp;Description&amp;nbsp;3)First&amp;nbsp;without&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;Language=&quot;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</helpText>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X5_Screen_Template_Target_Record_Id</name>
            <dataType>String</dataType>
            <fieldText>Template Target Record Id</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;This must be an existing record.  If you are using the default test Template set (sendBetterEmailTest), this should be a ContactId.&lt;/p&gt;</helpText>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X5_Screen_Related_Record_Id_for_testing_merge_fields_5</name>
            <dataType>String</dataType>
            <fieldText>Related Record Id (for testing merge fields)</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;This must be an existing record.  If you are using the default test Template set (sendBetterEmailTest), this should be a AccountId.&lt;/span&gt;&lt;/p&gt;</helpText>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X5_Screen_Related_Record_Type</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>RelatedRecordType</elementReference>
            </defaultValue>
            <fieldText>Related Record Type</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X5_Reply_To_Email_Address</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>ReplyTo Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testReturnAddress</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X5_Screen_Sender_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testSenderName</elementReference>
            </defaultValue>
            <fieldText>Sender Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>X6_Mass_Email</name>
        <label>6. Mass Email Test Flow</label>
        <locationX>520</locationX>
        <locationY>1112</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X6_Assign_from_Screen</targetReference>
        </connector>
        <fields>
            <name>Example6Details</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Flow Example 6&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;Send an email using MassEmail message&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;SendBetterEmail can also be used to send Mass Emails. Mass Emails are far more limited in functionality that Single Emails, though both can be bulked as a single send (up to 10) in this action. Mass emails cannot have language localization by target for obvious reasons (one template for a list of targets), so the selected language will apply to the entire list.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Since this is simply demonstrating the MassEmail functionality, only a single email is sent using the running user as the Recipient Record Id.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Parameters used:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;description [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Description(testMassEmailFinishedMessage)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;](&lt;/span&gt;&lt;span style=&quot;font-size: 9pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;sent in internal email with status after action completes&lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with&amp;nbsp;[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Template Name(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;testTemplateName&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;] (looked up or created if specified by name) (Default: sendBetterEmailTest)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;with related record id collection &lt;/span&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;[Recipient Record Id Collection(UserListForMassMail)]&lt;/b&gt;&lt;span style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;(consists of a single record, the user running the example)&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;You can, of course, vary the templates and object records to reflect your organization&apos;s needs.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X6_Finished_Message_Description</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>TestFlowMassSubject</elementReference>
            </defaultValue>
            <fieldText>Finished Message - Description</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;The message sent via email to the originator when all of the emails have been sent (or at least attempted to be sent); with status.&lt;/p&gt;</helpText>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X6_Template_Name_Mass_Email</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>DefaultMassEmailTemplateName</elementReference>
            </defaultValue>
            <fieldText>Template Name</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;Used&amp;nbsp;in&amp;nbsp;conjunction&amp;nbsp;with&amp;nbsp;Template&amp;nbsp;Language.&amp;nbsp;Finds&amp;nbsp;templates&amp;nbsp;with&amp;nbsp;the&amp;nbsp;name&amp;nbsp;matching&amp;nbsp;Template&amp;nbsp;Name&amp;nbsp;for&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;Language=&quot;xxx_YY&quot;&lt;/span&gt;&lt;span style=&quot;color: rgb(215, 186, 125);&quot;&gt;&apos;&lt;/span&gt;&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;&amp;nbsp;in&amp;nbsp;the&amp;nbsp;Description.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</helpText>
            <isRequired>true</isRequired>
        </fields>
        <helpText>&lt;p&gt;The message sent to the originator when all messages have been sent - with status.&lt;/p&gt;</helpText>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>X7_Bulk_email_using_request_collection</name>
        <label>7. Bulk email using request collection</label>
        <locationX>473</locationX>
        <locationY>1275</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X7_Bulk_Set_Up_Text_Subjects</targetReference>
        </connector>
        <fields>
            <name>Example1Details_0</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;Flow Example 7&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif; background-color: white;&quot;&gt;- Send bulk email using request collections&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;This is a complex, advanced functionality that should be used only when needed.&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;&amp;nbsp;&amp;nbsp;You are much better off using the standard functionality unless you have bulk requests that cannot be satisfied with the single SendBetterEmail request.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;SendBetterEmail can be used to send bulk email using &lt;/span&gt;&lt;i style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;collections&lt;/i&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt; of; 1) Single Email Requests, 2) Mass Email Requests, or 3) a blend of both.&amp;nbsp;All requests are (of course) subject to organization limits.&amp;nbsp;While this example just shows how to create a collection of requests using the &quot;Send Better Email Bulk Request Setup&quot; Apex action where each request is a single email, each request in the collection could send as many as the request type allows (subject to limits of course).&amp;nbsp;Consequently, if you create individual requests for the collection that each have a target object list (Recipient Records), each target will receive an email.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;Parameters for sendBetterEmail Action (actually send the request collection):&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Collection of sendBetterEmail Requests &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;[&lt;/b&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;emailRequests&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;(bulkSendBetterEmailRequest)]&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;Parameters for &apos;Send Better Email Bulk Request Setup&apos; (create a Single Email request)&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;to the addressee in [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;TO(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;send_Email_To&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;from[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Reply to Email&lt;/b&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;TestReturnAddress)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with the name [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Sender Display Name(testSenderName)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;using [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Subject(BulkSubject)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;] (formula)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;and [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Body(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; background-color: white;&quot;&gt;x1_HTML_Body&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; color: rgb(62, 62, 60); font-family: Arial, sans-serif;&quot;&gt;The flow works by creating a collection of requests, then send that collection to the sendBetterEmail action.&amp;nbsp;There can be no more than 10 of each request type (Single, Mass) in a collection.&amp;nbsp;The results of the collection request are returned as a collection of SendBetterEmailResponse, so if you want to check the results, you will need to loop through that response in the order of the original request collection.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X7_Screen_Email_To</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Recipient Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testEmailAddress1</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>disabled</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>readonly</name>
                <value>
                    <booleanValue>false</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>send_Email_To</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X7_Screen_Sender_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testSenderName</elementReference>
            </defaultValue>
            <fieldText>Sender Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X7_Screen_Subject</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>TestFlowSubject</elementReference>
            </defaultValue>
            <fieldText>Subject</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X7_Screen_HTML_Body</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>HTMLTextTemplate</elementReference>
            </defaultValue>
            <fieldText>HTML Body</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>X8_Email_Using_Template</name>
        <label>8. Email Using Template (Recipient and Target)</label>
        <locationX>402</locationX>
        <locationY>1048</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>X8_TemplateID_Identified</targetReference>
        </connector>
        <fields>
            <name>Example8Details</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Flow Example 8&lt;/b&gt;&lt;span style=&quot;font-size: 10.5pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt; Single Mail Template with merge fields from Recipient Record, Related To Record, Activity to Recipient and Task to Related To and a different Recipient&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;&lt;i&gt;NOTE: Before running this example flow, you must create record(s) for both the Recipient (a contact by default) and the Related Record (an Account Record by default) and have the Record Ids available&lt;/i&gt;&lt;/b&gt;&lt;i style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;This sends out an email using a specified Email Template with the addressee specified through the Recipient Record Id (TargetObjectId) and optionally (dependent on your Template) merge fields with an associated object record (WhatId).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;Parameters used:&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;sender [&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Sender Display Name(sendSender)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;]&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;reply to &lt;/span&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;[Reply Email Address&lt;/b&gt;&lt;b&gt;(testReturnAddress)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;with&amp;nbsp;[&lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Email Template Id(&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;templateId&lt;/b&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;)&lt;/b&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;] (looked up or created if specified by name)&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;sent to &lt;/span&gt;&lt;b style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;[&lt;/b&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;Recipient Record Id&lt;/b&gt;&lt;b&gt;(templateTargetId)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;with related record &lt;/span&gt;&lt;b style=&quot;font-size: 9pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;[Related Record Id(templateWhatId)]&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;Save Email as Activity on Recipient Record(s)&lt;/span&gt;[true]&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: black; background-color: white;&quot;&gt;Save Email as Task on recipient related record(s)&lt;/span&gt;[true]&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;For this example, you will need to create or use a template. Templates also require that you have a recipient record (targetObjectId) (e.g., Contact, User, . . .) which must also pre-exist.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;You will be required enter the ID for that record as the Recipient Record Id&lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;. Additionally if you intend to test merge fields (RelatedTo) with your template, You must also pre-create the related object record and have available the Id for that record as the Record Object Id (RecordId).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you are using the defaults, you will also need to:&lt;/span&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Create a Contact (for Recipient Object) and/or have the Id available.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif;&quot;&gt;Create an Account (for Related Record) and/or have the Id available.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;This example also creates an activity for the email which will be assigned to the Recipient Record Id and a task related to the Related Record Id.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;Note: These are independently settable in the Action.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you specify template by name and the templates do not exist, they will be created using Contact for the &lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;Recipient RecordType and Account for the Related RecordType.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60);&quot;&gt;If you use the default test templates (&lt;/span&gt;&lt;span style=&quot;font-size: 10pt; font-family: Arial, sans-serif; color: rgb(62, 62, 60); background-color: white;&quot;&gt;sendBetterEmailTest) the Target ID should be a ContactId and the Related Record should be an AccountId.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>X8_Screen_Template_RecordId</name>
            <dataType>String</dataType>
            <fieldText>Email Template Id (If Preferred)</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X8_Screen_Email_Template_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>DefaultTemplateName</elementReference>
            </defaultValue>
            <fieldText>Email Template Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X8_Screen_Recipient_Record_ID</name>
            <dataType>String</dataType>
            <fieldText>Recipient Record Id (Send to this record)</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X8_Screen_Template_Target_Record_Id</name>
            <dataType>String</dataType>
            <fieldText>Target Record Id (also for template merge fields and recording related Email as an activity)</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;This must be an existing record.  If you are using the default test templates (sendBetterEmailTest), it should be a ContactId&lt;/p&gt;</helpText>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>X8_Screen_Related_RecordId</name>
            <dataType>String</dataType>
            <fieldText>Related Record Id (also for template merge fields for related record and creating task on same)</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Related Record Id and Related Record Type both must either be used or blank.   One of them is blank.&lt;/p&gt;</errorMessage>
                <formulaExpression>ISBLANK({!X4_Related_RecordType}) == ISBLANK({!X4_Screen_Related_RecordId})</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>X8_Screen_Related_RecordType</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>RelatedRecordType</elementReference>
            </defaultValue>
            <fieldText>Related Record Type</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;&lt;span style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;This must be an existing record of a type that allows File Attachments.  If you are using the default test templates (sendBetterEmailTest), it should be an Accoun&lt;/span&gt;&lt;/p&gt;</helpText>
            <isRequired>false</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Related Record Id and Related Record Type both must either be used or blank.   One of them is blank.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>ISBLANK({!X4_Related_RecordType}) == ISBLANK({!X4_Screen_Related_RecordId})</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>MessageId_of_existing_email_if_this_is_InReplyTo</name>
            <dataType>String</dataType>
            <fieldText>MessageId of existing email if this is InReplyTo</fieldText>
            <fieldType>InputField</fieldType>
            <helpText>&lt;p&gt;Use the MessageId of an existing email to add this message to that email thread&lt;/p&gt;</helpText>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>X8_Screen_Reply_To_Email_Address</name>
            <extensionName>flowruntime:email</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>ReplyTo Email Address</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>placeholder</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>value</name>
                <value>
                    <elementReference>testReturnAddress</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>testReturnAddress</assignToReference>
                <name>value</name>
            </outputParameters>
        </fields>
        <fields>
            <name>X8_Screen_Sender_Name</name>
            <dataType>String</dataType>
            <defaultValue>
                <elementReference>testSenderName</elementReference>
            </defaultValue>
            <fieldText>Sender Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>147</locationX>
        <locationY>292</locationY>
        <connector>
            <targetReference>Choose_Example_Screen</targetReference>
        </connector>
    </start>
    <status>Draft</status>
    <subflows>
        <description>sendBetterEmail Test - Create Test Templates if Needed</description>
        <name>X4_Create_Test_Templates_if_Needed</name>
        <label>4. Create Test Templates if Needed</label>
        <locationX>895</locationX>
        <locationY>859</locationY>
        <connector>
            <targetReference>X4_Get_Id_From_TemplateName</targetReference>
        </connector>
        <flowName>sendBetterEmail_Test_Create_Test_Templates_if_needed</flowName>
        <inputAssignments>
            <name>sendBetterEmailTestName</name>
            <value>
                <elementReference>X4_Screen_Email_Template_Name</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <description>sendBetterEmail Test - Create Test Templates if Needed</description>
        <name>X5_Create_Test_Templates_if_Needed</name>
        <label>5. Create Test Templates if Needed</label>
        <locationX>1025</locationX>
        <locationY>983</locationY>
        <connector>
            <targetReference>X5_Multi_Lingual_Using_Email_Templates_Action</targetReference>
        </connector>
        <flowName>sendBetterEmail_Test_Create_Test_Templates_if_needed</flowName>
        <inputAssignments>
            <name>sendBetterEmailTestName</name>
            <value>
                <elementReference>X5_Screen_Template_Name</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>sendBetterEmailTestType</name>
            <value>
                <elementReference>X5_Screen_Related_Record_Type</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <description>sendBetterEmail Test - Create Mass Email Test Templates If Needed</description>
        <name>X6_Create_Mass_Email_Test_Templates_If_Needed</name>
        <label>6. Create Mass Email Test Templates If Needed</label>
        <locationX>1036</locationX>
        <locationY>1112</locationY>
        <connector>
            <targetReference>Assign_User_ID_for_TargetIds</targetReference>
        </connector>
        <flowName>sendBetterEmail_Test_Create_Test_Templates_if_needed</flowName>
        <inputAssignments>
            <name>sendBetterEmailTestName</name>
            <value>
                <elementReference>X6_Template_Name_Mass_Email</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>sendBetterEmailTestType</name>
            <value>
                <stringValue>MassEmail</stringValue>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <description>sendBetterEmail Test - Create Test Templates if Needed</description>
        <name>X8_Create_Test_Templates_if_Needed</name>
        <label>8. Create Test Templates if Needed</label>
        <locationX>650</locationX>
        <locationY>1466</locationY>
        <connector>
            <targetReference>X8_Get_Id_From_TemplateName</targetReference>
        </connector>
        <flowName>sendBetterEmail_Test_Create_Test_Templates_if_needed</flowName>
        <inputAssignments>
            <name>sendBetterEmailTestName</name>
            <value>
                <elementReference>X8_Screen_Email_Template_Name</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <textTemplates>
        <name>HTMLTextTemplate</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;This is some &lt;span style=&quot;color: rgb(41, 25, 215);&quot;&gt;body text &lt;/span&gt;created using the rich text editor in the &lt;b&gt;Text Template&lt;/b&gt; resource in &lt;u style=&quot;font-size: 22px;&quot;&gt;Flow&lt;/u&gt;.&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>plainTextBody</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;This is some body text created using the rich text editor in the Text Template resource in Flow.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;This email is being sent to this set of email addresses that came from a string collection:&lt;/p&gt;&lt;p&gt;{!stringCollectionEmailAddresses}&lt;/p&gt;</text>
    </textTemplates>
    <variables>
        <description>Counter for number of bulk items in loop</description>
        <name>bulk_counter</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>bulkSendBetterEmailRequest</name>
        <apexClass>SendBetterEmailRequest</apexClass>
        <dataType>Apex</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>A collection of subject names for bulkification testing</description>
        <name>bulkSubjectNames</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>bulkThisSendBetterEmailRequest</name>
        <apexClass>SendBetterEmailRequest</apexClass>
        <dataType>Apex</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>bulkThisSubject</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>bulkThisSubjectLine</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>Bulk_Set_up_Test_Requests</elementReference>
        </value>
    </variables>
    <variables>
        <name>cd_counter</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>content_document_ids</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>cur_cd_id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>cur_cdl</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>curAttachments</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Attachment</objectType>
    </variables>
    <variables>
        <name>curContacts</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>curLeads</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Lead</objectType>
    </variables>
    <variables>
        <name>curUsers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>User</objectType>
    </variables>
    <variables>
        <name>errorsFromEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>filtered_cdls</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>isSuccess</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>List of MessageIds of existing email if this is InReplyTo</description>
        <name>ListOfInReplyToEmailMessageIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>massEmailUserCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>User</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>The related record (versus the TargetObject) which can be used for merge fields in the email templates.
The value must be one of the following types:
 Account
 Asset
 Campaign
 Case
 Contract
 Opportunity
 Order
 Product
 Solution
 Custom</description>
        <name>RelatedRecordType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Account</stringValue>
        </value>
    </variables>
    <variables>
        <name>send_Email_To</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>For adding sender name to emails</description>
        <name>sendSubject</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>TestFlowSubject</elementReference>
        </value>
    </variables>
    <variables>
        <name>stringCollectionEmailAddresses</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>templateRecipientId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>templateTargetId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>used for testing email merges</description>
        <name>templateWhatId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>testContactContains</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>testContact</stringValue>
        </value>
    </variables>
    <variables>
        <description>A test email address for checking if an email is actually sent.</description>
        <name>testEmailAddress1</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>DefaultRecipientEmailAddress1</elementReference>
        </value>
    </variables>
    <variables>
        <description>A second email address  for testing actual sends if desired</description>
        <name>testEmailAddress2</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>DefaultRecipientEmailAddress2</elementReference>
        </value>
    </variables>
    <variables>
        <description>The message sent to the originator when all emails have been attempted</description>
        <name>testMassEmailFinishedMessage</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>testPlainTextBody</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>This is the plain text version line 1.\nLine 2.\nLine 3.</stringValue>
        </value>
    </variables>
    <variables>
        <description>A return address if an actual email is requested</description>
        <name>testReturnAddress</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>DefaultReplyToEmail</elementReference>
        </value>
    </variables>
    <variables>
        <name>testSenderName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>DoNotReply</stringValue>
        </value>
    </variables>
    <variables>
        <name>testSubject</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>This is a test email from sendBetterEmail</stringValue>
        </value>
    </variables>
    <variables>
        <description>The template Id to be used in the action</description>
        <name>testTemplateId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>The specific language to send the email in</description>
        <name>testTemplateLanguage</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>The name of the template from which to search for language</description>
        <name>testTemplateName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>For testing list/collection of recipients if the user name contains this value</description>
        <name>testUserContains</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>testUserValue</stringValue>
        </value>
    </variables>
    <variables>
        <description>Create a user list for mass email</description>
        <name>UserListForMassMail</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Plain Text for Body 1</description>
        <name>x1_HTML_Body</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>testPlainTextBody</elementReference>
        </value>
    </variables>
    <variables>
        <description>Plain Text Body for example 2</description>
        <name>x2_HTML_Body</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>plainTextBody</elementReference>
        </value>
    </variables>
</Flow>
